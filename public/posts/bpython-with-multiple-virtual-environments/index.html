<!doctype html><html><head lang=en><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Using one bpython with multiple virtual environments - Alex' Blog</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="I finally realized that I should change the default Python REPL. There are many REPLs that offer a much better experience—ipython, bpython, and ptpython are probably the most well-known. In the past, I used ipython because I worked on many projects that involved Jupyter notebooks, so it came essentially for free whenever I installed the necessary packages.
However, in recent years, I&rsquo;ve been working on a lot of projects that don&rsquo;t rely on Jupyter, meaning ipython wasn’t installed by default. This meant I always had to manually install it in any virtual environment where I wanted to use it—which I didn’t like, as I prefer to keep only project-specific dependencies in a virtual environment."><meta property="og:image" content><meta property="og:url" content="http://localhost:1313/posts/bpython-with-multiple-virtual-environments/"><meta property="og:site_name" content="Alex' Blog"><meta property="og:title" content="Using one bpython with multiple virtual environments"><meta property="og:description" content="I finally realized that I should change the default Python REPL. There are many REPLs that offer a much better experience—ipython, bpython, and ptpython are probably the most well-known. In the past, I used ipython because I worked on many projects that involved Jupyter notebooks, so it came essentially for free whenever I installed the necessary packages.
However, in recent years, I’ve been working on a lot of projects that don’t rely on Jupyter, meaning ipython wasn’t installed by default. This meant I always had to manually install it in any virtual environment where I wanted to use it—which I didn’t like, as I prefer to keep only project-specific dependencies in a virtual environment."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-29T20:49:33+02:00"><meta property="article:modified_time" content="2024-09-29T20:49:33+02:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="TIL"><meta property="article:tag" content="Venv"><meta property="article:tag" content="REPL"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using one bpython with multiple virtual environments"><meta name=twitter:description content="I finally realized that I should change the default Python REPL. There are many REPLs that offer a much better experience—ipython, bpython, and ptpython are probably the most well-known. In the past, I used ipython because I worked on many projects that involved Jupyter notebooks, so it came essentially for free whenever I installed the necessary packages.
However, in recent years, I’ve been working on a lot of projects that don’t rely on Jupyter, meaning ipython wasn’t installed by default. This meant I always had to manually install it in any virtual environment where I wanted to use it—which I didn’t like, as I prefer to keep only project-specific dependencies in a virtual environment."><script src=http://localhost:1313/js/feather.min.js></script><link href=http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css><link id=darkModeStyle rel=stylesheet type=text/css href=http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css disabled><link rel=stylesheet type=text/css href=http://localhost:1313/css/carousel.7246d67ed223552bcaacc5e2e16718046d961485b18484de18ab08df89eb9988.css></head><body><div class=content><header><div class=main><a href=http://localhost:1313/>Alex' Blog</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/tags>Tags</a>
| <span id=dark-mode-toggle onclick=toggleTheme()></span>
<script src=http://localhost:1313/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>Using one bpython with multiple virtual environments</h1><div class=meta>Posted on Sep 29, 2024</div></div><section class=body><p>I finally realized that I should change the default Python REPL. There are many REPLs that offer a much better experience—<a href=https://ipython.org/>ipython</a>, <a href=https://bpython-interpreter.org/>bpython</a>, and <a href=https://github.com/prompt-toolkit/ptpython>ptpython</a> are probably the most well-known. In the past, I used ipython because I worked on many projects that involved Jupyter notebooks, so it came essentially for free whenever I installed the necessary packages.</p><p>However, in recent years, I&rsquo;ve been working on a lot of projects that don&rsquo;t rely on Jupyter, meaning ipython wasn’t installed by default. This meant I always had to manually install it in any virtual environment where I wanted to use it—which I didn’t like, as I prefer to keep only project-specific dependencies in a virtual environment.</p><p>As a result, I relied on the plain old <code>python</code> REPL, with all its shortcomings—especially the difficulty of pasting code snippets (which, thankfully, will be improved with <a href=https://docs.python.org/3.13/whatsnew/3.13.html#whatsnew313-better-interactive-interpreter>Python 3.13</a>).</p><p>Today, I started wondering if there was a way to use a REPL like <code>bpython</code> in every environment I have. You can install it once with <a href=https://github.com/pypa/pipx><code>pipx</code></a> and use it everywhere, but it won&rsquo;t find any packages by default. While searching online, I came across a promising post on <a href=https://stackoverflow.com/a/22182421>Stack Overflow</a>. Although the post was from 2014 and the exact approach didn&rsquo;t work, with a bit of fiddling, I found a solution that seems to work. I added the following function to my <code>.zshrc</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#66d9ef>function</span> bp<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> test -n <span style=color:#e6db74>&#34;</span>$VIRTUAL_ENV<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        PP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.</span><span style=color:#66d9ef>$(</span>python -c <span style=color:#e6db74>&#39;import sys; print(&#34;:&#34;.join(sys.path))&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> 
</span></span><span style=display:flex><span>        PYTHONPATH<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>PP<span style=color:#e6db74>}</span> bpython <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        bpython <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Now, I can simply type <code>bp</code>, and it will either start <code>bpython</code> directly or, if a virtual environment is active, it will set the <code>PYTHONPATH</code> to include the venv directory before starting the REPL.</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/python>Python</a></li><li><a href=/tags/til>TIL</a></li><li><a href=/tags/venv>venv</a></li><li><a href=/tags/repl>REPL</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/alex-ruehe rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>